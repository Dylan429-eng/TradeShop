<link rel="stylesheet" href="/css/produits/edit.css">

<div class="min-h-screen">
  <div class="max-w-4xl mx-auto px-4">
    <!-- Header -->
    <div class="header-flex">
      <h1 class="header-title">Modifier le Produit</h1>
      <a href="/admin/produits" class="btn-back">⬅ Retour</a>
    </div>

    <!-- Formulaire -->
    <div class="form-container">
      <form method="POST" action="/admin/produitUpdate/<%= produit.id %>" enctype="multipart/form-data">
        <input type="hidden" name="_csrf" value="<%= csrfToken %>">

        <!-- Nom -->
        <label class="form-label">Nom du Produit<span style="color:#dc2626;">*</span></label>
        <input type="text" name="nom" value="<%= produit.nom %>" required class="form-input">
        <% if (errors.nom) { %>
          <div class="form-error"><%= errors.nom %></div>
        <% } %>

        <!-- Description -->
        <label class="form-label">Description <span style="color:#dc2626;">*</span></label>
        <textarea name="description" rows="4" required class="form-textarea"><%= produit.description %></textarea>
        <% if (errors.description) { %>
          <div class="form-error"><%= errors.description %></div>
        <% } %>

        <!-- Prix & Stock -->
        <div class="grid-2">
          <div>
            <label class="form-label">Prix <span style="color:#dc2626;">*</span></label>
            <input type="number" name="prix" value="<%= produit.prix %>" step="0.01" min="0" required class="form-input">
            <% if (errors.prix) { %>
              <div class="form-error"><%= errors.prix %></div>
            <% } %>
          </div>
          <div>
            <label class="form-label">Stock <span style="color:#dc2626;">*</span></label>
            <input type="number" name="stock" value="<%= produit.stock %>" min="0" required class="form-input">
            <% if (errors.stock) { %>
              <div class="form-error"><%= errors.stock %></div>
            <% } %>
          </div>
        </div>

        <!-- Catégorie -->
        <label class="form-label">Catégorie <span style="color:#dc2626;">*</span></label>
        <select name="categorie_id" required class="form-select">
          <% categories.forEach(cat => { %>
            <option value="<%= cat.id %>" <%= produit.categorie_id == cat.id ? 'selected' : '' %>><%= cat.type %></option>
          <% }) %>
        </select>
        <% if (errors.categorie_id) { %>
          <div class="form-error"><%= errors.categorie_id %></div>
        <% } %>

        <!-- Image actuelle -->
        <% if (produit.image) { %>
          <p class="image-upload-info">Image actuelle :</p>
          <img src="<%= produit.image %>" class="image-preview">
        <% } %>

        <!-- Nouvelle image -->
        <label class="form-label"><%= produit.image ? 'Changer l’image' : 'Ajouter une image' %></label>
        <div class="image-upload-box">
          <input type="file" name="image" accept="image/*" class="form-input">
        </div>
        <% if (errors.image) { %>
          <div class="form-error"><%= errors.image %></div>
        <% } %>

        <!-- Actions -->
        <div class="action-btns">
          <a href="/admin/produits" class="btn-cancel">Annuler</a>
          <button type="submit" class="btn-submit">Mettre à jour</button>
        </div>
      </form>
    </div>
  </div>
</div>
